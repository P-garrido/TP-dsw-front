{"version":3,"names":["cov_2fhjxhopi4","actualCoverage","s","http_1","require","core_1","service_1","log_in_service_1","rxjs_1","ServicesService","constructor","http","loginService","f","serviceToEdit","Service","baseUrl","buyBaseUrl","getAllServices","get","filterServices","serviceDescription","url","getAllBoughtServices","token","headers","HttpHeaders","set","addService","service","post","deleteService","idService","delete","editService","id","patch","buyService","idUser","idCli","idServ","date","data","value","hourAmmount","clientMessage","message","pipe","catchError","handleError","editServiceClient","serviceClient","serviceDate","parseInt","deleteServiceClient","idClient","error","status","b","throwError","console","tslib_1","__decorate","Injectable","providedIn","HttpClient","LogInService","exports"],"sources":["C:\\Users\\Usuario\\repos(Desarrollo)\\TP-dsw-front\\src\\app\\services.service.ts"],"sourcesContent":["import { HttpClient, HttpErrorResponse, HttpHeaders } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { BoughtService } from './models/boughtService';\r\nimport { EditBoughtService } from './models/editBoughtService';\r\nimport { EditServiceEvent } from './models/editServiceEvent';\r\nimport { Service } from './models/service';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { LogInService } from './log-in.service';\r\nimport { catchError, throwError } from 'rxjs';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ServicesService {\r\n\r\n  constructor(private http: HttpClient, private loginService: LogInService) {\r\n\r\n  }\r\n\r\n  serviceToEdit: Service = new Service(-1, \"\", 0, \"\");\r\n\r\n\r\n  readonly baseUrl = \"http://localhost:1234/services\";\r\n  readonly buyBaseUrl = \"http://localhost:1234/services-clients\";\r\n\r\n\r\n\r\n  getAllServices() {\r\n    return this.http.get<Service[]>(this.baseUrl);\r\n  }\r\n\r\n\r\n  filterServices(serviceDescription: String) {\r\n    let url: string = this.baseUrl + `/descService/${serviceDescription}`;\r\n    return this.http.get<Service[]>(url);\r\n  }\r\n\r\n\r\n  getAllBoughtServices() {\r\n    const token = this.loginService.token;\r\n    const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\r\n    return this.http.get<BoughtService[]>(this.buyBaseUrl, { headers });\r\n  }\r\n\r\n  addService(service: Service) {\r\n    const token = this.loginService.token;\r\n    const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\r\n    return this.http.post<Service>(this.baseUrl, { service }, { headers });\r\n  }\r\n\r\n  deleteService(idService: number) {\r\n    const url = this.baseUrl + `/${idService}`;\r\n    const token = this.loginService.token;\r\n    const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\r\n    return this.http.delete(url, { headers });\r\n  }\r\n\r\n  editService(service: Service) {\r\n    const url = this.baseUrl + `/${service.id}`;\r\n    const token = this.loginService.token;\r\n    const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\r\n    return this.http.patch<Service>(url, { service }, { headers });\r\n  }\r\n\r\n  buyService(service: EditServiceEvent, idUser: number) {\r\n    const url = this.buyBaseUrl;\r\n    const token = this.loginService.token;\r\n    const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\r\n    return this.http.post<any>(url, {\r\n      idCli: idUser,\r\n      idServ: service.id,\r\n      date: service.data.value.date,\r\n      hourAmmount: null,\r\n      clientMessage: service.data.value.message\r\n    },\r\n      { headers }).pipe(catchError(this.handleError))\r\n  }\r\n\r\n  editServiceClient(serviceClient: EditBoughtService) {\r\n    const url = this.buyBaseUrl + `/${serviceClient.idService}/${serviceClient.idUser}/${serviceClient.serviceDate}`;\r\n    const token = this.loginService.token;\r\n    const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\r\n    return this.http.patch<any>(url, {\r\n      hourAmmount: parseInt(serviceClient.hourAmmount.value)\r\n    }, { headers }).pipe(catchError(this.handleError));\r\n  }\r\n\r\n  deleteServiceClient(idService: number, idClient: number, serviceDate: Date) {\r\n    const url = this.buyBaseUrl + `/${idService}/${idClient}/${serviceDate}`;\r\n    const token = this.loginService.token;\r\n    const headers = new HttpHeaders().set('Authorization', `Bearer ${token}`);\r\n    return this.http.delete(url, { headers });\r\n\r\n  }\r\n\r\n  private handleError(error: HttpErrorResponse) {\r\n    if (error.status === 401) {\r\n      return throwError(\"No Token\");\r\n    } else {\r\n      console.error('Ocurrió un error inesperado:', error.message);\r\n    }\r\n\r\n    return throwError('Algo salió mal, inténtalo de nuevo más tarde.');\r\n  }\r\n}\r\n"],"mappings":"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"}